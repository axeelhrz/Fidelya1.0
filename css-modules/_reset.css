/* ===== RESET MODULE ===== */

/* ===== RESET MEJORADO ===== */
*, *::before, *::after {
  box-sizing: border-box;
  padding: 0;
  margin: 0;
}

html {
  width: 100%;
  height: 100%;
  padding: 0;
  margin: 0;
  overflow-x: hidden;
  font-size: 16px;
  scroll-behavior: smooth;
}

body {
  position: relative;
  width: 100%;
  min-height: 100vh;
  min-height: 100dvh;
  padding: 0;
  margin: 0;
  overflow-x: hidden;
  font-family: var(--font-primary);
  line-height: 1.5;
  color: var(--text-primary);
  background: var(--primary-bg);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ===== ACCESIBILIDAD MEJORADA ===== */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    transition-duration: 0.01ms !important;
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
  }

  .nav__logo,
  .nav__list,
  .btn--primary,
  .btn--cta::after,
  .hero__phone-container,
  .hero::before,
  .hero::after,
  .floating-orb-2,
  .floating-orb-3,
  .contact__channel,
  .contact__badge,
  .ambient-glow,
  .feature-ambient-glow,
  .nav__toggle,
  .floating-widget__main-btn,
  .floating-widget__menu-item,
  .floating-widget__main-icon,
  .language-switcher__btn {
    animation: none !important;
  }

  .btn--cta,
  .btn--cta-video,
  .btn--footer {
    animation: none !important;
  }
}

/* ===== NOTA IMPORTANTE ===== */

/*
Esta corrección acelera las transiciones que estaban configuradas como:
- --transition: 0.6s (600ms) → 0.25s (250ms)
- --transition-slow: 1s (1000ms) → 0.4s (400ms)
- --transition-fast: 0.3s (300ms) → 0.15s (150ms)

Esto hace que las interacciones se sientan mucho más responsivas y naturales,
especialmente en el navbar y los botones.
*/
body {
  overflow: hidden auto !important;
}

/* ===== CORRECCIÓN PARA ASEGURAR QUE EL VIEWPORT TERMINE CORRECTAMENTE ===== */
@media screen and (width <= 1023px) {
  body {
    padding-bottom: 0 !important;
    margin-bottom: 0 !important;
  }

  .contact {
    padding-bottom: var(--mobile-section-padding) !important;
    margin-bottom: 0 !important;
  }

  .contact__footer {
    padding-bottom: max(var(--space-2xl), calc(env(safe-area-inset-bottom, 0px) + var(--space-xl))) !important;
    margin-bottom: 0 !important;
  }
}

/* ===== CORRECCIÓN ESPECÍFICA PARA WEBKIT (SAFARI) ===== */
@supports (-webkit-appearance: none) {
  body {
    -webkit-overflow-scrolling: touch !important;
  }

  .contact__footer-content {
    transform: translateZ(0) !important;
    transform: translateZ(0) !important;
  }
}

/* ===== CORRECCIÓN PARA FIREFOX ===== */
@-moz-document url-prefix() {
  body {
    overflow-x: hidden !important;
  }
}

/* ===== CORRECCIONES CSS PARA EL DRAWER MÓVIL - PRESERVAR SCROLL ===== */

/* Aplicar solo en dispositivos móviles */
@media screen and (width <= 1023px) {
  /* ===== PREVENIR SCROLL DEL BODY CUANDO EL DRAWER ESTÁ ABIERTO ===== */
  body.no-scroll {
    /* Usar position fixed en lugar de overflow hidden para preservar scroll */
    position: fixed !important;
    width: 100% !important;
    overflow-y: scroll !important; /* Mantener scrollbar para evitar saltos */
    -webkit-overflow-scrolling: touch !important;
  }

  /* ===== ASEGURAR QUE EL OVERLAY NO INTERFIERA CON EL SCROLL ===== */
  .nav__menu::before {
    /* El overlay debe cubrir toda la pantalla pero no afectar el scroll */
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    z-index: -1 !important;
    width: 100vw !important;
    height: 100vh !important;
    height: 100dvh !important;
    pointer-events: none !important;
    visibility: hidden !important;
    background: rgb(0 0 0 / 70%) !important;
    backdrop-filter: blur(5px) !important;
    backdrop-filter: blur(5px) !important;
    opacity: 0 !important;
    transition: opacity 0.4s ease, visibility 0.4s ease !important;

    /* No debe afectar el layout del documento */
    contain: layout style paint !important;
  }

  .nav__menu.active::before {
    pointer-events: auto !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* ===== DRAWER PRINCIPAL - OPTIMIZADO PARA PRESERVAR SCROLL ===== */
  .nav__menu {
    /* Posicionamiento que no afecta el scroll del documento */
    position: fixed !important;
    top: 0 !important;
    left: -100% !important;
    z-index: 1000 !important;
    width: min(320px, 85vw) !important;
    height: 100vh !important;
    height: 100dvh !important;

    /* Transición suave */
    transition: left 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
    transform: translateZ(0) !important;
    will-change: transform !important;

    /* No debe afectar el layout del documento */
    contain: layout style paint !important;
    backface-visibility: hidden !important;
  }

  .nav__menu.active {
    left: 0 !important;
  }

  /* ===== ENLACES ACTIVOS - MEJORAR VISIBILIDAD ===== */
  .nav__link.active {
    color: var(--starflex-red) !important;
    text-shadow: 0 0 10px rgb(255 45 85 / 50%) !important;

    /* Hacer más visible el enlace activo */
    background: rgb(255 45 85 / 20%) !important;
    border-left-color: var(--starflex-red) !important;
    box-shadow:
      0 0 20px rgb(255 45 85 / 30%),
      inset 0 1px 0 rgb(255 255 255 / 15%) !important;
    transform: translateX(12px) !important;
  }

  .nav__link.active::before {
    width: 100% !important;
    background: linear-gradient(90deg,
    rgb(255 45 85 / 25%) 0%,
    rgb(255 45 85 / 15%) 100%
  ) !important;
    opacity: 1 !important;
  }

  .nav__link.active::after {
    color: var(--starflex-red) !important;
    text-shadow: 0 0 8px rgb(255 45 85 / 60%) !important;
    opacity: 1 !important;
    transform: translateX(0) !important;
  }

  /* ===== TRANSICIONES SUAVES PARA CAMBIOS DE ESTADO ===== */
  .nav__link {
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
  }

  .nav__link::before {
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
  }

  .nav__link::after {
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
  }

  /* ===== OPTIMIZACIONES PARA DISPOSITIVOS DE BAJO RENDIMIENTO ===== */
  @media (prefers-reduced-motion: reduce) {
    .nav__menu {
      transition: left 0.2s ease !important;
    }

    .nav__menu::before {
      backdrop-filter: none !important;
      backdrop-filter: none !important;
      transition: opacity 0.2s ease, visibility 0.2s ease !important;
    }

    .nav__link,
    .nav__link::before,
    .nav__link::after {
      transition: all 0.2s ease !important;
    }
  }

  /* ===== CORRECCIONES PARA DIFERENTES ALTURAS DE PANTALLA ===== */
  @media screen and (height <= 600px) {
    /* En pantallas pequeñas, asegurar que el drawer sea completamente visible */
    .nav__menu {
      overflow-y: auto !important;
      -webkit-overflow-scrolling: touch !important;
    }
  }

  /* ===== CORRECCIONES PARA WEBKIT (SAFARI) ===== */
  @supports (-webkit-appearance: none) {
    body.no-scroll {
      -webkit-overflow-scrolling: touch !important;
    }

    .nav__menu {
      transform: translateZ(0) !important;
      transform: translateZ(0) !important;
      backface-visibility: hidden !important;
      backface-visibility: hidden !important;
    }
  }

  /* ===== CORRECCIONES PARA DISPOSITIVOS CON NOTCH ===== */
  @supports (padding: max(0px)) {
    .nav__menu {
      padding-right: max(20px, env(safe-area-inset-right)) !important;
      padding-left: max(20px, env(safe-area-inset-left)) !important;
    }
  }

  /* ===== ASEGURAR QUE NO HAY CONFLICTOS CON OTROS ELEMENTOS ===== */
  .nav__toggle,
  .nav__close {
    position: relative !important;

    /* Asegurar que los botones estén por encima del overlay */
    z-index: 1001 !important;
  }

  /* ===== CORRECCIÓN PARA EVITAR SALTOS VISUALES ===== */
  html {
    /* Asegurar que el scroll sea suave en toda la página */
    scroll-behavior: smooth !important;
    overflow-x: hidden !important;
  }

  body {
    min-height: 100vh !important;
    min-height: 100dvh !important;

    /* Evitar saltos horizontales */
    overflow-x: hidden !important;
  }

  /* ===== CORRECCIÓN PARA MANTENER EL ANCHO DURANTE EL FIXED ===== */
  body.no-scroll {
    box-sizing: border-box !important;

    /* Mantener el ancho exacto para evitar saltos de layout */
    width: 100vw !important;
    max-width: 100vw !important;
  }

}
